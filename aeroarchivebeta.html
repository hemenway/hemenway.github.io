<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Leaflet + GeoRasterLayer (COG)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
  <style>html,body,#map{height:100%;margin:0}</style>
</head>
<body>
  <div id="map"></div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://unpkg.com/proj4@2.11.0/dist/proj4.js"></script>
  <script src="https://unpkg.com/proj4leaflet@1.0.2/dist/proj4leaflet.js"></script>
  <script src="https://unpkg.com/georaster/dist/georaster.bundle.min.js"></script>
  <script src="https://unpkg.com/georaster-layer-for-leaflet/dist/georaster-layer-for-leaflet.min.js"></script>

  <script>
  const url = "https://aeromap.io/201209N_geo_COG.tif";

  const map = L.map("map").setView([20,0], 2);
  L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
    attribution: "&copy; OpenStreetMap contributors", maxZoom: 19
  }).addTo(map);

  parseGeoraster(url).then(georaster => {
    console.log("projection from COG:", georaster.projection);

    // If projection is known EPSG (e.g., "EPSG:32616") but proj4 doesn't know it yet, define it here:
    // Example only â€” replace with your CRS if needed
    // proj4.defs("EPSG:32616","+proj=utm +zone=16 +datum=WGS84 +units=m +no_defs +type=crs");

    const layer = new GeoRasterLayer({
      georaster,
      opacity: 0.85,
      resolution: 256
    }).addTo(map);

    layer.once("load", () => {
      try {
        const b = layer.getBounds();
        if (b && b.isValid()) map.fitBounds(b, {padding:[20,20]});
      } catch(e) { console.warn(e); }
    });
  }).catch(err => console.error("Raster load error:", err));
  </script>
</body>
</html>
